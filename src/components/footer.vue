<template>
  <div class="footer">
    <svg
      id="logo"
      xmlns="http://www.w3.org/2000/svg"
      width="150"
      height="33.912"
      viewBox="0 0 177.5 33.912"
    >
      <g id="logo-svg" transform="translate(-278 -73)">
        <g id="Gruppe_7" data-name="Gruppe 7" transform="translate(-28)">
          <path
            id="Pfad_7"
            data-name="Pfad 7"
            d="M13.356-17.82a5.267,5.267,0,0,0-1.584-.216,6.179,6.179,0,0,0-4.9,2.34V-17.82H2.412V0h4.86V-8.892c0-3.06,1.872-4.644,4.788-4.644h1.3ZM32.4-7.272a11.464,11.464,0,0,0,.324-2.664,8.108,8.108,0,0,0-8.388-8.28,9.191,9.191,0,0,0-9.324,9.324A9.341,9.341,0,0,0,24.768.432,10.9,10.9,0,0,0,31.9-2.232L29.88-5.544a8.035,8.035,0,0,1-4.968,1.8c-2.592,0-4.428-1.26-5-3.528Zm-12.492-3.42a4.389,4.389,0,0,1,4.248-3.6,3.626,3.626,0,0,1,3.852,3.6Zm31.536.108c0-4.932-2.988-7.632-7.632-7.632a9.717,9.717,0,0,0-7.776,3.672l2.52,2.988C40.14-13.248,41.436-14,43.272-14c2.16,0,3.312,1.152,3.312,3.132v.792H42.12c-4.14,0-6.732,1.98-6.732,5.184,0,3.132,2.376,5.328,6.156,5.328a7.424,7.424,0,0,0,5.436-2.16V0h4.464ZM46.584-6.66A3.543,3.543,0,0,1,42.84-3.132c-1.548,0-2.556-.756-2.556-1.944s.9-1.8,2.484-1.8h3.816ZM69.084-27v10.908a6.887,6.887,0,0,0-5.328-2.124c-4.968,0-8.64,3.96-8.64,9.324S58.788.432,63.756.432A6.78,6.78,0,0,0,69.48-2.2V0h4.464V-27Zm.072,18.108c0,3.2-2.052,4.9-4.5,4.9-2.628,0-4.608-1.944-4.608-4.932a4.6,4.6,0,0,1,4.608-4.9C67.1-13.824,69.156-12.06,69.156-8.892Zm25.992,1.62a11.463,11.463,0,0,0,.324-2.664,8.108,8.108,0,0,0-8.388-8.28A9.191,9.191,0,0,0,77.76-8.892,9.341,9.341,0,0,0,87.516.432a10.9,10.9,0,0,0,7.128-2.664L92.628-5.544a8.035,8.035,0,0,1-4.968,1.8c-2.592,0-4.428-1.26-5-3.528Zm-12.492-3.42a4.389,4.389,0,0,1,4.248-3.6,3.626,3.626,0,0,1,3.852,3.6ZM110.2-17.82a5.267,5.267,0,0,0-1.584-.216,6.179,6.179,0,0,0-4.9,2.34V-17.82H99.252V0h4.86V-8.892c0-3.06,1.872-4.644,4.788-4.644h1.3Zm15.192,0-4.644,11.7-4.356-11.7H111.24l6.84,16.74L117.54.144a3.547,3.547,0,0,1-3.708,2.412c-.288,0-.972-.036-2.088-.144V6.48a12.14,12.14,0,0,0,3.132.432c3.312,0,5.472-1.656,7.092-5.364L130.5-17.82Z"
            transform="translate(353 100)"
            fill="#454D57"
          />
          <g
            id="Icon_ionic-ios-book"
            data-name="Icon ionic-ios-book"
            transform="translate(302.618 73.5)"
          >
            <path
              id="Pfad_1"
              data-name="Pfad 1"
              d="M11.895,4.507c4.7,0,8.7,1.962,8.7,5.766V11.4h0V31.359c0,.155-.27.19-.33.049V31.4A7.846,7.846,0,0,0,13.1,26.445a12.548,12.548,0,0,0-8.1,2.609,1.054,1.054,0,0,1-.574.2H4.043c-.322,0-.661-.19-.661-.429V8.452C3.373,6.195,7.191,4.507,11.895,4.507Z"
              fill="#46ccff"
            />
            <path
              id="Pfad_2"
              data-name="Pfad 2"
              d="M27.4,4.5c-4.7,0-8.7,1.962-8.7,5.766v1.125h0V31.352c0,.155.27.19.33.049v-.007a7.935,7.935,0,0,1,7.156-4.957,12.546,12.546,0,0,1,8.1,2.609,1.113,1.113,0,0,0,.574.2h.391c.322,0,.661-.19.661-.429V8.438C35.92,6.188,32.1,4.5,27.4,4.5Z"
              transform="translate(3.626)"
              fill="#46ccff"
            />
          </g>
        </g>
      </g>
    </svg>
    <div id="footer-content">
      <table id="footer-links">
        <tr>
          <td>
            <router-link to="/">Home</router-link>
          </td>
          <td>
            <router-link to="/contact">Contact us</router-link>
          </td>
        </tr>
        <tr>
          <td>
            <router-link to="/about">Why Readery</router-link>
          </td>
          <!--<td>
            <router-link to="/plans">Terms of Service</router-link>
          </td>-->
        </tr>
        <tr>
          <td>
            <router-link to="/plans">Plans</router-link>
          </td>
          <!--<td>
            <router-link to="/login">Imprint</router-link>
          </td>-->
        </tr>
        <tr>
          <td>
            <router-link to="/login">Login</router-link>
          </td>
        </tr>
      </table>
    </div>
    <div id="newsletter-wrapper">
      <h3 id="newsletter-heading">Stay updated</h3>
      <div id="newsletter-field">
        <input v-model="email" type="email" placeholder="Enter your E-Mail" id="newsletter-input" />
        <button id="newsletter-send" @click="signupSubscriber()">Send</button>
      </div>
      <span
        v-bind:class="{ showErrorEmail: emailError !== null }"
        class="error-email"
      >{{emailError}}</span>
      <div id="success-message">
        <span
          v-bind:class="{ showSuccessMessage: (successMessage!== null) }"
          class="success-message"
        >{{successMessage}}</span>
      </div>
      <div id="spinner-wrapper">
        <HalfCircleSpinner
          :animation-duration="1000"
          :size="30"
          color="rgb(70, 204, 255)"
          class="spinner"
          v-bind:class="{loadingSpinner: loadSpinner}"
        />
      </div>
    </div>

    <div id="footer-bottom">
      <h3>Â© Readery GmbH 2020</h3>
      <div id="social-media">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 81.577 81.558">
          <path
            id="Icon_awesome-instagram"
            data-name="Icon awesome-instagram"
            d="M40.792,22.106A20.911,20.911,0,1,0,61.7,43.017,20.877,20.877,0,0,0,40.792,22.106Zm0,34.505A13.595,13.595,0,1,1,54.387,43.017,13.619,13.619,0,0,1,40.792,56.611Zm26.643-35.36a4.877,4.877,0,1,1-4.877-4.877A4.866,4.866,0,0,1,67.435,21.251ZM81.285,26.2c-.309-6.533-1.8-12.321-6.588-17.089-4.768-4.768-10.555-6.26-17.089-6.588-6.734-.382-26.916-.382-33.65,0-6.515.309-12.3,1.8-17.089,6.57S.609,19.649.281,26.183C-.1,32.916-.1,53.1.281,59.833c.309,6.533,1.8,12.321,6.588,17.089s10.555,6.26,17.089,6.588c6.734.382,26.916.382,33.65,0,6.533-.309,12.321-1.8,17.089-6.588,4.768-4.768,6.26-10.555,6.588-17.089.382-6.734.382-26.9,0-33.632Zm-8.7,40.857a13.763,13.763,0,0,1-7.753,7.753c-5.369,2.129-18.108,1.638-24.041,1.638s-18.69.473-24.041-1.638A13.763,13.763,0,0,1,9,67.058C6.869,61.689,7.361,48.95,7.361,43.017S6.888,24.327,9,18.976a13.763,13.763,0,0,1,7.753-7.753C22.12,9.094,34.859,9.585,40.792,9.585s18.69-.473,24.041,1.638a13.763,13.763,0,0,1,7.753,7.753c2.129,5.369,1.638,18.108,1.638,24.041S74.715,61.707,72.586,67.058Z"
            transform="translate(0.005 -2.238)"
            fill="#454D57"
          />
        </svg>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 100.221 81.398"
        >
          <path
            id="Icon_awesome-twitter"
            data-name="Icon awesome-twitter"
            d="M89.92,23.667c.064.89.064,1.781.064,2.671,0,27.154-20.667,58.441-58.441,58.441A58.045,58.045,0,0,1,0,75.558a42.492,42.492,0,0,0,4.96.254,41.136,41.136,0,0,0,25.5-8.776A20.577,20.577,0,0,1,11.256,52.792a25.9,25.9,0,0,0,3.879.318,21.724,21.724,0,0,0,5.405-.7A20.543,20.543,0,0,1,4.07,32.252V32A20.686,20.686,0,0,0,13.354,34.6,20.571,20.571,0,0,1,6.995,7.133,58.385,58.385,0,0,0,49.348,28.627a23.188,23.188,0,0,1-.509-4.706A20.56,20.56,0,0,1,84.387,9.867a40.44,40.44,0,0,0,13.036-4.96,20.485,20.485,0,0,1-9.03,11.319,41.177,41.177,0,0,0,11.828-3.179,44.154,44.154,0,0,1-10.3,10.62Z"
            transform="translate(0 -3.381)"
            fill="#454D57"
          />
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 43.757 81.699">
          <path
            id="Icon_awesome-facebook-f"
            data-name="Icon awesome-facebook-f"
            d="M42.5,45.956,44.768,31.17H30.581V21.575c0-4.045,1.982-7.988,8.336-7.988h6.45V1A78.653,78.653,0,0,0,33.917,0C22.234,0,14.6,7.082,14.6,19.9V31.17H1.609V45.956H14.6V81.7H30.581V45.956Z"
            transform="translate(-1.609)"
            fill="#454D57"
          />
        </svg>
      </div>
    </div>
  </div>
</template>

<script>
import axios from "axios";
import { HalfCircleSpinner } from "epic-spinners";

export default {
  name: "Footer",
  components: {
    HalfCircleSpinner
  },
  data() {
    return {
      email: null,
      emailError: null,
      successMessage: null,
      loadSpinner: false
    };
  },
  methods: {
    signupSubscriber() {
      //Check if currently loading
      if (this.loadSpinner === false) {
        this.emailError = null;
        this.successMessage = null;

        this.email = this.email.toString().toLowerCase();

        if (this.validateEmail(this.email)) {
          //send request to sign up

          const subscriber = {
            email: this.email,
            time_joined: Date.now()
          };

          this.loadSpinner = true;

          axios
            .post(
              "https://readery-backend.herokuapp.com/api/newsletter/signup",
              subscriber
            )
            .then(response => {
              this.loadSpinner = false;

              if (
                response.data.error !== undefined &&
                response.data.error !== null
              ) {
                //Error
                console.log(
                  "An error occured: " + response.data.error.toString()
                );
                this.emailError = response.data.error;
              } else {
                //Login user
                this.successMessage =
                  this.email + " was added to our subscriber list. Thank you!";
                this.email = "";
              }
            })
            .catch(e => {
              console.log("User creation request Error: " + e.toString());
            });
        } else {
          this.emailError = "Please enter a valid email";
        }
      }
    },
    validateEmail(email) {
      if (email !== null && email !== "") {
        if (/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(email)) {
          return true;
        }
      }
      return false;
    }
  }
};
</script>

<style scoped>
.footer {
  height: 500px;
  background-color: #e7edf4;
  padding: 5% 15%;
  display: flex;
  align-items: flex-start;
  flex-direction: column;
  justify-content: space-between;
}
#logo {
  width: 150px;
}
#footer-content {
  width: 100%;
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
  align-items: center;
}

#footer-links {
  margin-top: 2%;
  min-width: 300px;
}
#footer-links td {
  width: 200px;
  text-align: left;
}
#footer-links tr {
  height: 35px;
}
#footer-links a {
  margin: 20px 0;
  text-decoration: none;
  text-transform: uppercase;
  /* color: #d0dbe8; */
  color: #454d57;

  font-weight: 400;
  font-size: 14px;
  letter-spacing: 1px;
}
#newsletter-wrapper {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  width: 100%;
  padding: 5% 0 0 0;
}
#newsletter-heading {
  font-size: 20px;
  font-weight: 500;
}

#newsletter-field {
  margin: 2% 0 0 0;
  height: 60px;
  width: 100%;
  background-position: center;
  background-size: cover;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

#newsletter-field input {
  height: 100%;
  border: none;
  width: 70%;
  font-family: cera-pro;
  font-size: 16px;
  padding: 0 15px;
  font-weight: 300;
  outline: none;
}
#newsletter-field input:focus {
  border: none;
  outline: none;
}
#newsletter-field button {
  height: 100%;
  border: none;
  padding: 0;
  width: 25%;
  background-color: #40caff;
  color: #fff;
  font-family: cera-pro;
  font-size: 16px;
  cursor: pointer;
  transition: 0.2s ease-in;
}
#newsletter-field button:hover {
  border: none;
  outline: none;
  background-color: #1ab5f1;
  transition: 0.2s ease-out;
}
#newsletter-field button:focus {
  border: none;
  outline: none;
}

#spinner-wrapper {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 20px;
}

.spinner {
  display: none;
}
.loadingSpinner {
  display: block;
}

.error-email {
  display: none;
  color: #ff5d73;
  transition: 0.2s ease-in;
}
.showErrorEmail {
  display: block;
  font-size: 12px;
  font-weight: 400;
  text-align: left;
  transition: 0.2s ease-out;
  margin-top: 10px;
}

#success-message {
  width: 100%;
}
.success-message {
  display: none;
  color: #1b1f23;
}
.showSuccessMessage {
  display: block;
  font-size: 14px;
  font-weight: 400;
  text-align: left;
  margin-top: 10px;
  transition: 0.2s ease-out;
}

#footer-bottom {
  margin-top: 3%;
  width: 50%;
  min-width: 350px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
#footer-bottom h3 {
  color: #454d57;
  font-size: 14px;
  font-weight: 300;
}
#social-media {
  margin: 0 2%;
  width: 130px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
@media screen and (max-width: 1280px) {
  .footer {
    padding: 10% 5%;
    height: 500px;
    justify-content: space-between;
  }
  #newsletter-field {
    width: 100%;
    min-width: 0px;
  }
  #newsletter-field input {
    width: 70%;
    font-family: cera-pro;
    font-size: 16px;
    padding: 0 15px;
    font-weight: 300;
    outline: none;
  }

  #newsletter-field button {
    height: 100%;
    padding: 0 10%;
    min-width: 100px;
  }
  #footer-links {
    width: 100%;
    min-width: 0px;
  }
  #footer-bottom {
    width: 100%;
    min-width: 0px;
  }
}
</style>
